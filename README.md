# ISAC End-to-End Autoencoder (MATLAB & PyTorch)

This project implements a hybrid **Integrated Sensing and Communications (ISAC)** end-to-end autoencoder. It utilizes MATLAB for high-fidelity physical layer data generation—including hardware impairments and antenna steering—and PyTorch for training deep neural networks to perform joint radar sensing and communication message recovery.

## Project Structure

* **`AE.m`**: MATLAB script to generate training and testing datasets. It simulates antenna spacing perturbations, target AoA, and communication channel coefficients.
* **`train_isac_ae.py`**: PyTorch script that loads the generated `.mat` file, builds the neural architectures, and trains the ISAC receiver.
* **`isac_data.mat`**: Intermediate data file generated by MATLAB (v7 format for compatibility).
* **`ISAC_Results.png`**: Visual performance summary including loss curves, uncertainty calibration, and detection distributions.

---

## Technical Specifications

The system models a Multi-Antenna array ($K=16$) under specific hardware impairments ($\sigma_{\lambda} = \lambda/30$).

| Parameter | Value |
| :--- | :--- |
| **Antennas (K)** | 16 |
| **Message Alphabet (M)** | 4 (4-QAM) |
| **Comm SNR** | 20 dB |
| **Radar SNR** | 0 dB |
| **Target AoA Range** | [-20°, 20°] |
| **Comm AoD Range** | [30°, 50°] |

### Neural Network Components
The receiver is composed of four specialized sub-networks:
* **Presence Detector**: Binary classifier for radar target detection.
* **Angle Estimator**: Regression network for target AoA estimation.
* **Uncertainty Estimator**: Uses a **Softplus** activation to provide a variance estimate ($\sigma$) for the predicted angle.
* **Comm Receiver**: Recovers symbols using received signals and Channel State Information (CSI).

---

## Installation & Usage

### 1. Requirements
* **MATLAB** (R2020b or newer recommended)
* **Python 3.x**
* **PyTorch, NumPy, Matplotlib, SciPy, h5py**

### 2. Workflow
1.  **Data Generation**: Open MATLAB and run `AE.m`. This generates `isac_data.mat` with 500,000 training samples by default.
2.  **Training**: Run the Python script:
    ```bash
    python train_isac_ae.py
    ```
3.  **Evaluation**: The script outputs the Symbol Error Rate (SER), Detection Probability ($P_d$), and Angle RMSE, while saving a results dashboard to `ISAC_Results.png`.

---

## Loss Function
The model optimizes a weighted joint loss function:
$$L = \omega_r (L_{det} + 0.5 L_{reg}) + (1 - \omega_r) L_{comm}$$
Where $\omega_r$ (default 0.09) balances the trade-off between sensing accuracy and communication throughput.

---

## Results
Based on simulations with hardware impairments:
* **Uncertainty Calibration**: The model learns to estimate its own error; the actual error follows the estimated $\sigma$.
* **Detection Performance**: Clear separation in detection scores ($q$) between $H_0$ (no target) and $H_1$ (target present). This project implements a hybrid **Integrated Sensing and Communications (ISAC)** end-to-end autoencoder. It utilizes MATLAB for high-fidelity physical layer data generation—including hardware impairments and antenna steering—and PyTorch for training deep neural networks to perform joint radar sensing and communication message recovery.

## Project Structure

* **`AE.m`**: MATLAB script to generate training and testing datasets. It simulates antenna spacing perturbations, target AoA, and communication channel coefficients.
* **`train_isac_ae.py`**: PyTorch script that loads the generated `.mat` file, builds the neural architectures, and trains the ISAC receiver.
* **`isac_data.mat`**: Intermediate data file generated by MATLAB (v7 format for compatibility).
* **`ISAC_Results.png`**: Visual performance summary including loss curves, uncertainty calibration, and detection distributions.

---

## Technical Specifications

The system models a Multi-Antenna array ($K=16$) under specific hardware impairments ($\sigma_{\lambda} = \lambda/30$).

| Parameter | Value |
| :--- | :--- |
| **Antennas (K)** | 16 |
| **Message Alphabet (M)** | 4 (4-QAM)  |
| **Comm SNR** | 20 dB |
| **Radar SNR** | 0 dB |
| **Target AoA Range** | [-20°, 20°] |
| **Comm AoD Range** | [30°, 50°] |

### Neural Network Components
The receiver is composed of four specialized sub-networks:
* **Presence Detector**: Binary classifier for radar target detection.
* **Angle Estimator**: Regression network for target AoA estimation.
* **Uncertainty Estimator**: Uses a **Softplus** activation to provide a variance estimate ($\sigma$) for the predicted angle.
* **Comm Receiver**: Recovers symbols using received signals and Channel State Information (CSI).

---

## Installation & Usage

### 1. Requirements
* **MATLAB** (R2020b or newer recommended)
* **Python 3.x**
* **PyTorch, NumPy, Matplotlib, SciPy, h5py**
    
### 2. Workflow
1.  **Data Generation**: Open MATLAB and run `AE.m`. This generates `isac_data.mat` with 500,000 training samples by default.
2.  **Training**: Run the Python script:
    ```bash
    python train_isac_ae.py
    ``` 
3.  **Evaluation**: The script outputs the Symbol Error Rate (SER), Detection Probability ($P_d$), and Angle RMSE, while saving a results dashboard to `ISAC_Results.png`.

---

## Loss Function
The model optimizes a weighted joint loss function:
$$L = \omega_r (L_{det} + 0.5 L_{reg}) + (1 - \omega_r) L_{comm}$$
Where $\omega_r$ (default 0.09) balances the trade-off between sensing accuracy and communication throughput.

---

## Results
Based on simulations with hardware impairments:
* **Uncertainty Calibration**: The model learns to estimate its own error; the actual error follows the estimated $\sigma$.
* **Detection Performance**: Clear separation in detection scores ($q$) between $H_0$ (no target) and $H_1$ (target present).

## Acknowledgements

Special thanks to [Charitha S](https://github.com/Cherry-29) for providing continuous aid and support in developing the project.
